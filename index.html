<!doctype html>
<html lang="ru" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Paradise — Mini App</title>
  <meta name="theme-color" content="#0b0b0c" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root{
      --bg:#ffffff; --text:#0f0f0f; --muted:#6b7280; --card:#f7f7f8; --border:#e5e7eb; --primary:#111827;
      --brand-green:#1e7b3d; --brand-beige:#e5c991;
      --enter-duration:260ms; --exit-duration:200ms;
    }
    html[data-theme="dark"]{
      --bg:#0b0b0c; --text:#f3f4f6; --muted:#9ca3af; --card:#141417; --border:#22242a; --primary:#f3f4f6;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}

    /* Layout */
    .page{min-height:100%;display:grid;grid-template-rows:auto 1fr auto}
    .container{max-width:980px;margin:0 auto;padding:0 16px}
    header.header{
      position:sticky;top:0;z-index:20;backdrop-filter:blur(10px);
      background:color-mix(in oklab,var(--bg) 86%, transparent);
      border-bottom:1px solid var(--border);
    }
    .header-inner{display:flex;align-items:center;justify-content:space-between;padding:12px 0;gap:10px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700;letter-spacing:.4px}
    .brand img{height:24px;display:block}
    nav.tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab{
      appearance:none;border:1px solid var(--border);background:transparent;color:var(--text);
      border-radius:12px;padding:8px 12px;font-size:14px;cursor:pointer;text-decoration:none;
      transition:background .15s ease,border-color .15s ease, color .15s ease;
    }
    .tab:hover{background:var(--card)}
    .tab.active{background:var(--brand-green);color:#fff;border-color:var(--brand-green)}
    .actions{display:flex;gap:8px}

    /* Viewport & transitions */
    main#app{position:relative;overflow:hidden;min-height:calc(100dvh - 150px)}
    .view{
      position:absolute; inset:0; overflow:auto; padding:20px 0;
      opacity:0; transform:translateY(8px); pointer-events:none;
      background:var(--bg);
    }
    .view.enter-active{animation:enter var(--enter-duration) ease forwards}
    .view.exit-active{animation:exit var(--exit-duration) ease forwards}
    .view.active{opacity:1; transform:none; pointer-events:auto}
    @keyframes enter{from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:translateY(0)}}
    @keyframes exit{from{opacity:1;transform:translateY(0)} to{opacity:0;transform:translateY(-8px)}}

    /* Reusable */
    .hero{ text-align:center; padding:28px 0; }
    .hero .logo{max-width:420px;width:86%;height:auto;display:block;margin:0 auto 10px;
      filter:drop-shadow(0 12px 28px rgba(0,0,0,.18))}
    h1{font-size:28px;margin:6px 0}
    .subtitle{margin:0;color:var(--muted)}
    .cta{margin:16px auto 0;display:flex;gap:8px;justify-content:center;flex-wrap:wrap}
    .btn{
      background:transparent;color:var(--text);border:1px solid var(--border);
      border-radius:12px;padding:10px 14px;text-decoration:none;display:inline-flex;
      align-items:center;gap:8px;cursor:pointer;font-size:14px;transition:background .15s ease,border-color .15s ease
    }
    .btn:hover{background:var(--card)}
    .btn.primary{background:var(--brand-green);border-color:var(--brand-green);color:#fff}
    .btn.beige{background:var(--brand-beige);border-color:var(--brand-beige);color:#1a1a1a}
    .muted{color:var(--muted)}
    .section{margin-top:12px}
    .grid{margin-top:16px;display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
    @media(min-width:720px){.grid{grid-template-columns:repeat(4,minmax(0,1fr))}}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px;min-height:110px;transition:transform .16s ease}
    .card:hover{transform:translateY(-2px)}
    footer.footer{padding:14px 0;color:var(--muted);border-top:1px solid var(--border);text-align:center}

    /* Категории меню с фото */
    .cat-card {
      position: relative; overflow: hidden; border-radius: 14px; border: 1px solid var(--border);
      background: var(--card); aspect-ratio: 3/2; isolation: isolate;
    }
    .cat-card img { width:100%; height:100%; object-fit:cover; display:block; transition: transform .35s ease; }
    .cat-card::after { content:""; position:absolute; inset:0;
      background: linear-gradient(to top, rgba(0,0,0,.42), rgba(0,0,0,0) 55%); opacity:.9; mix-blend-mode:multiply; }
    .cat-card:hover img { transform: scale(1.04); }
    .cat-meta { position:absolute; left:12px; right:12px; bottom:12px; z-index:1; color:#fff; text-shadow:0 2px 8px rgba(0,0,0,.25); }
    .cat-title{font-weight:700; font-size:16px; margin:0 0 2px;}
    .cat-sub{opacity:.9; font-size:13px; margin:0;}
    .cat-card.noimg{ background:linear-gradient(140deg, color-mix(in oklab, var(--brand-beige) 55%, transparent), var(--card));
      display:grid; place-items:end start; padding:12px; }
    .cat-card.noimg .cat-title, .cat-card.noimg .cat-sub { color: var(--text); text-shadow:none; }
  </style>
</head>
<body>
  <div class="page">

    <!-- HEADER -->
    <header class="header">
      <div class="container header-inner">
        <div class="brand">
          <img src="logo-paradise.webp" alt="" onerror="this.remove()">
          <span>Paradise</span>
        </div>
        <nav class="tabs" id="tabs">
          <a class="tab" data-route="home"    href="#/home">Главная</a>
          <a class="tab" data-route="menu"    href="#/menu">Меню</a>
          <a class="tab" data-route="booking" href="#/booking">Бронь</a>
          <a class="tab" data-route="promo"   href="#/promo">Акции</a>
          <a class="tab" data-route="contacts" href="#/contacts">Контакты</a>
        </nav>
        <div class="actions">
          <button id="themeToggle" class="tab" type="button">Тема</button>
        </div>
      </div>
    </header>

    <!-- APP VIEWPORT -->
    <main id="app" class="container" aria-live="polite" aria-busy="false"></main>

    <!-- FOOTER -->
    <footer class="footer">
      © <span id="year"></span> Paradise. Донецк.
    </footer>
  </div>

  <!-- TEMPLATES -->
  <template id="tpl-home">
    <section class="hero">
      <img class="logo" src="logo-paradise.webp" alt="Paradise Restaurant" onerror="this.remove()">
      <h1>Добро пожаловать в Paradise</h1>
      <p class="subtitle">Премиум · минимализм · вкус</p>
      <div class="cta">
        <a class="btn primary" href="#/booking">Забронировать</a>
        <a class="btn beige" href="#/menu">Открыть меню</a>
      </div>
      <p class="muted" style="margin-top:12px" id="envNote"></p>
    </section>
  </template>

  <template id="tpl-menu">
    <section>
      <h1>Меню</h1>
      <p class="muted">Выберите категорию:</p>
      <div class="grid">
        <a class="cat-card" href="#/menu?cat=salads">
          <img src="menu-salads.webp" alt="Салаты" onerror="this.closest('.cat-card').classList.add('noimg'); this.remove();" loading="lazy">
          <div class="cat-meta"><p class="cat-title">Салаты</p><p class="cat-sub">Лёгкие и свежие</p></div>
        </a>
        <a class="cat-card" href="#/menu?cat=hot">
          <img src="menu-hot.webp" alt="Горячее" onerror="this.closest('.cat-card').classList.add('noimg'); this.remove();" loading="lazy">
          <div class="cat-meta"><p class="cat-title">Горячее</p><p class="cat-sub">Горячие блюда Paradise</p></div>
        </a>
        <a class="cat-card" href="#/menu?cat=desserts">
          <img src="menu-desserts.webp" alt="Десерты" onerror="this.closest('.cat-card').classList.add('noimg'); this.remove();" loading="lazy">
          <div class="cat-meta"><p class="cat-title">Десерты</p><p class="cat-sub">Нежные сладости</p></div>
        </a>
        <a class="cat-card" href="#/menu?cat=drinks">
          <img src="menu-drinks.webp" alt="Напитки" onerror="this.closest('.cat-card').classList.add('noimg'); this.remove();" loading="lazy">
          <div class="cat-meta"><p class="cat-title">Напитки</p><p class="cat-sub">Классика и авторские</p></div>
        </a>
      </div>
    </section>
  </template>

  <template id="tpl-booking">
    <section>
      <h1>Бронирование</h1>
      <p class="muted">Эта форма демо. В релизе отправим менеджеру в Telegram.</p>
      <form id="bookingForm" class="section" onsubmit="event.preventDefault(); window.handleBooking?.();">
        <input id="name"  placeholder="Имя" required />
        <input id="phone" placeholder="Телефон" required />
        <div class="grid" style="grid-template-columns:repeat(2,1fr);">
          <input id="date" type="date" required />
          <input id="time" type="time" required />
        </div>
        <select id="guests">
          <option>1 гость</option><option>2 гостя</option><option>3 гостя</option>
          <option>4 гостя</option><option>5 гостей</option><option>6 гостей</option>
        </select>
        <textarea id="notes" placeholder="Пожелания (у окна, тихая зона)…"></textarea>
        <button class="btn primary" type="submit">Отправить (демо)</button>
      </form>
    </section>
  </template>

  <template id="tpl-promo">
    <section>
      <h1>Акции</h1>
      <div class="grid">
        <div class="card"><strong>Сет «Друзья»</strong><br><span class="muted">-20% по будням 12–16</span></div>
        <div class="card"><strong>Авторский десерт</strong><br><span class="muted">в подарок к кофейному сету</span></div>
      </div>
    </section>
  </template>

  <template id="tpl-contacts">
    <section>
      <h1>Контакты</h1>
      <p><strong>Адрес:</strong> Донецк, Paradise</p>
      <p><strong>Телефон:</strong> <a href="tel:+79990000000">+7 (999) 000-00-00</a></p>
      <p><strong>Время работы:</strong> 11:00–23:00</p>
      <div class="cta">
        <a class="btn" target="_blank" rel="noopener" href="https://yandex.ru/maps/?whatshere%5Bpoint%5D=37.802%2C48.002&whatshere%5Bzoom%5D=16">Открыть навигатор</a>
        <a class="btn primary" href="tel:+79990000000">Позвонить</a>
      </div>
    </section>
  </template>

  <script>
    (function () {
      const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;
      const root = document.documentElement;
      const app = document.getElementById("app");
      const tabs = Array.from(document.querySelectorAll("#tabs .tab"));
      const THEME_KEY = "paradise_theme";
      const BOT_LINK = "https://t.me/your_bot_here"; // ← ВСТАВЬ ссылку на своего бота!

      /* === ТЕМА (фикс матча) === */
      function prefersDark() {
        try {
          return !!(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
        } catch (e) { return false; }
      }
      function setTheme(theme){
        root.setAttribute("data-theme", theme);
        localStorage.setItem(THEME_KEY, theme);
        try{ if (tg) tg.setHeaderColor(theme === "dark" ? "#0b0b0c" : "#ffffff"); }catch(e){}
      }
      const saved = localStorage.getItem(THEME_KEY);
      setTheme(saved || (prefersDark() ? "dark" : "light"));
      document.getElementById("themeToggle")?.addEventListener("click", () => {
        setTheme((root.getAttribute("data-theme") || "light") === "light" ? "dark" : "light");
      });

      /* === ROUTER (SPA, hash-based) === */
      const routes = {
        home:     document.getElementById("tpl-home").content,
        menu:     document.getElementById("tpl-menu").content,
        booking:  document.getElementById("tpl-booking").content,
        promo:    document.getElementById("tpl-promo").content,
        contacts: document.getElementById("tpl-contacts").content,
      };

      let currentView = null;
      function mount(route){
        const tpl = routes[route] || routes.home;
        const next = document.createElement("section");
        next.className = "view enter-active";
        next.appendChild(tpl.cloneNode(true));

        tabs.forEach(t => t.classList.toggle("active", t.dataset.route === route));

        if (currentView){
          currentView.classList.remove("active");
          currentView.classList.add("exit-active");
          setTimeout(() => currentView && currentView.remove(), 180);
        }
        app.appendChild(next);
        requestAnimationFrame(() => next.classList.add("active"));
        currentView = next;

        afterMount(route);
      }

      function afterMount(route){
        if (route === "home"){
          const envNote = document.getElementById("envNote");
          if (envNote) envNote.textContent = tg ? "Открыто в Telegram WebApp" : "Открыто в браузере";
        }
        if (route === "booking"){
          window.handleBooking = function(){
            const data = {
              name:  document.getElementById("name").value.trim(),
              phone: document.getElementById("phone").value.trim(),
              date:  document.getElementById("date").value,
              time:  document.getElementById("time").value,
              guests:document.getElementById("guests").value,
              notes: document.getElementById("notes").value.trim()
            };
            try{ if (tg){ tg.sendData(JSON.stringify({type:"booking_demo", data})); } }catch(_){}
            alert("Заявка отправлена (демо). Позже подключим отправку менеджеру в Telegram.");
          };
        }
      }

      function getRoute(){
        const h = location.hash.replace(/^#\/?/, "");
        const key = (h.split("?")[0] || "home").toLowerCase();
        return routes[key] ? key : "home";
      }
      window.addEventListener("hashchange", () => mount(getRoute()));

      /* === Telegram init (без падений) === */
      try{
        if (tg){
          tg.ready(); tg.expand();
          tg.MainButton.setText("Забронировать");
          tg.MainButton.onClick(() => tg.openTelegramLink(BOT_LINK));
          tg.MainButton.show();
        }
      }catch(e){ /* игнор */ }

      /* === Init === */
      document.getElementById("year").textContent = new Date().getFullYear();
      if (!location.hash) location.hash = "#/home";
      mount(getRoute());
    })();
  </script>
</body>
</html>
